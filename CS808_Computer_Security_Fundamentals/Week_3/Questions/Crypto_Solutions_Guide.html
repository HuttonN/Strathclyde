<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crypto</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="cryptography-comprehension-questions">Cryptography Comprehension Questions</h1>
<h2 id="question-1">Question 1</h2>
<p>Block ciphers can operate in either ECB mode or CBC mode.</p>
<p>a) Explain the difference between these two modes of operation. What extra information is required for CBC which isn’t required for ECB?<br>
<em>CBC performs an XOR operation with the output of the previous step before encryption, as such it requires an initialisation vector. ECB encrypts block by block.</em><br>
b) Construct a scenario which demonstrates the weakness of ECB mode.<br>
<em>ECB doesn’t mask patterns, as such any constructed scenario which exploits this is an acceptable solution.<br>
Imagine you have a text file with encrypted text in it which has salary information, if you identify a single salary, and it repeats – you know that salary for multiple people. If you happen to know which block is the salary, you could also replace that with another one.</em></p>
<h2 id="question-2">Question 2</h2>
<p>What are the three properties which make a hash function a cryptographic hash function, and why are they important?<br>
<em>It is deterministic: The same input using the same hash function always provides the same hash value. This means the same input results in same hash so we can check integrity of data,<br>
It is pre-image resistant: This means that given a random input, it is computationally infeasible to determine the input from the hash value alone. This effectively is a one-way function. This means it is difficult for an attacker to determine original input.<br>
It is second image resistant: Given a hash value h1 it should be computationally infeasible to find a different input message which results in the same hash value h1 This means attacker can’t easily find a version of input which results in the same output, hence would pass integrity check but data has been altered</em></p>
<h2 id="question-3">Question 3</h2>
<p>a) What form of attack can a MAC help mitigate?<br>
<em>Altering encrypted data in a block cipher</em></p>
<p>b) How does a MAC mitigate this?<br>
<em>It provides a way of checking the integrity of the data by making use of cryptographic hash functions based on secret keys and appended to the message, only those with the secret key can calculate the hash value, so if data is changed the attacker shouldn’t be able to predict the altered hash value</em><br>
c) Why can’t we simply append a hash value to the end of the encrypted data to mitigate the attack?<br>
<em>Because this too could be altered to match the altered data. See the class material on MACs for further detail.</em></p>
<h2 id="question-4">Question 4</h2>
<p>a) Compare and contrast p-boxes and s-boxes</p>
<p>b) How does AES use p-boxes and s-boxes?</p>
<h2 id="question-5">Question 5</h2>
<p>In your own words, explain how a digital signature mitigates an attack in which the attacker intercepts the communication from sender to recipient and replaces the document with their own document.</p>
<h2 id="question-6">Question 6</h2>
<p>You and a friend have public and private key pairs.<br>
a) How can you send secret messages to each other?</p>
<p><em>This question tests that you understand the difference between the use of public and private keys for encryption. If you wish to encrypt something only the other person can read, you must use their public key, as only the corresponding private key can decrypt this.</em></p>
<p>b) What could information security property could you achieve if you encrypted a message with your private key and released the cipher text?</p>
<p><em>This question tests that you understand that public key crypto can be used for reasons other than confidentiality. By encrypting with your private key you don’t achieve confidentiality as those with your public key can decrypt it. However, it can contribute to authenticity of the message.</em></p>
<p>c) How could you combine encryption using different keys to provide confidentiality and authenticity?</p>
<p><em>This question asks you to use different keys for layered encryption to achieve a range of security properties. You can encrypt using your private key for authenticity, then encrypt the result with the recipient’s public key to ensure confidentiality.</em></p>
<h1 id="cryptography-scenario-based-questions">Cryptography Scenario-based Questions</h1>
<h2 id="question-1-1">Question 1</h2>
<p>Alain Thénardiers often uses his company’s secure email server. He has lost his private key, but still has the corresponding public key.</p>
<p>a) Is he still able to send encrypted emails? What about receiving?</p>
<p><em>So long as he has the public key of who he is sending to. Yes, he can receive but he won’t be able to decrypt without his private key.</em></p>
<p>b) Is he still able to sign the email he sends? What about verifying the signatures of emails he received?</p>
<p><em>No – he needs his private key to encrypt a hash of the document. Verifying – yes, so long as he has the sender’s public key</em></p>
<p>c) What must he do to be capable of carrying out all of the operations above?<br>
<em>Revoke the old key pair and generate a new key pair</em></p>
<h2 id="question-2-1">Question 2</h2>
<p>A group of n people would like to use a public key encryption system to exchange confidential information pairwise. That is each person should be able to communicate privately with each other person in the group, without anyone else being able to read the message.</p>
<h3 id="a">a)</h3>
<p>Bob would like to send Alice encrypted and signed information. They are both members of the group. What keys must Bob use to achieve this?</p>
<p><em>Bob’s private key to sign, alice’s public to encrypt</em></p>
<h3 id="b">b)</h3>
<p>Name a well-known asymmetric encryption system, explain how it works The group has decided to use a hybrid system – using a combination of asymmetric and symmetric encryption.</p>
<p><em>RSA is covered in the module</em></p>
<h3 id="c">c)</h3>
<p>Why might the group have decided to do this?</p>
<p><em>Public key crypto can be comparatively  slow, symmetric is generally faster. A system can use a public key to establish a symmetric key over an insecure channel and the use a symmetric cipher for faster encryption. You can find this in real world use such as in Whatsapp or TLS for secure websites</em></p>
<h2 id="question-3-1">Question 3</h2>
<p>Demonstrate how RSA generates keys using p=2, q=7.</p>
<p>This question is designed to help you appreciate the mechanisms used in generating key pairs. It is a toy example i.e. not suitable for real world use, but demonstrates the algorithm. You are not expected to complete such calculations in the exam, but are expected to understand how RSA key generation and encryption works as a whole.</p>
<p>The first step is to calculate <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex"> n = p \times q </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span></span> i.e. n = 14<br>
This number is the modulus we will work with.<br>
The next step is to calculate:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>∗</mo><mn>6</mn><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex"> \phi (n) = (p-1)(q-1)= 1*6 = 6 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">6</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">6</span></span></span></span></span></span></p>
<p>Pick <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>&lt;</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> e \lt \varphi (n) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></span> and greater than 1, i.e. greater than 1 and less than 14 in this example. e also must be co-prime (their largest common divisor is 1) with n and  <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">  \varphi (n) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></span><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex"> e = 5 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">5</span></span></span></span></span></span> works in this instance.</p>
<p>Now we must find a value for d. The following must be true<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mo>×</mo><mi>e</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex"> d \times e (mod( \phi (n))) = 1  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span></span><br>
For this example, this means<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>d</mi><mo>×</mo><mn>5</mn><mo stretchy="false">)</mo><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mn>6</mn></mrow><annotation encoding="application/x-tex"> (d\times 5) \equiv 1 mod 6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">5</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord">6</span></span></span></span></span></span></p>
<p>Thus we know that  5d is equal to a multiple of 6 plus 1</p>
<p>If we consider each multiple of 5 i.e. 5, 10, 15, 20, 25 and so forth then calculate these mod 6 to find a multiple which results in a value of 1 mod 6.<br>
e.g. 10 mod 6 is 4 so 2 is not the value of d. However, 25 mod 6 is 1, so d=5 would work as would 11. We will use 11 as d.</p>
<p>So now we have d=11, and e = 5. This provides the values we require for decryption and encryption.</p>
<p>The combination of  <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex"> e, n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">n</span></span></span></span></span></span> provides the public key, whilst the combination of  <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex"> d, n </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">n</span></span></span></span></span></span> provides the private key.</p>
<p>In this instance this means 5, 14 is the public key, whilst 11, 14 is the private key.</p>
<p>Let’s encrypt a single letter for ease C, need to convert to a number, lets say 3. We then need to calculate 3^5 mod 14 i.e. 243 mod 14 = 5.</p>
<h2 id="question-4-1">Question 4</h2>
<p>Your friend Miriam (who lives next door) has decided they would like to share a file with you, but only with you. Miriam decided to encrypt the file before sending it to you.</p>
<p>a) What type of encryption (symmetric or asymmetric) should Miriam use? Given your choice, propose a specific algorithm and explain to Miriam on a high level how it works.<br>
*This could be argued in different ways. Given they live next to each other there will be no issue in sharing a key, thus symmetric seems the obvious choice.  AES and Blowfish are both examples of symmetric ciphers which are discussed in the module. *<br>
b) Miriam doesn’t know how Diffie-Hellman relates to public key encryption, explain how they are related.<br>
*This question aims to address a common misconception. Diffie-Hellman is a key exchange algorithm which allows two parties to agree a symmetric key over an insecure channel. In contrast, public key cryptography is a system which generates a key pair, one of which is made public and the other is kept private. *</p>
<h2 id="question-5-1">Question 5</h2>
<p>Design a cipher which uses a Fiestel structure. Note it need not meet the formal requirements of a secure cipher.</p>
<p><em>This question aims to develop your understanding of the Fiestel structure. Any solution which uses the structure for encryption and defines a number of rounds, a block size (even is easiest) and a function f is acceptable. One possibility is 16 rounds, 16 bit blocks, and XOR as the function.</em></p>
</div>
</body>

</html>
