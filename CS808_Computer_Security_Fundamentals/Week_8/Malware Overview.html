<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malware Overview</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="malware-overview">Malware Overview</h1>
<p>Malware is a specific type of software which has been designed to complete malicious activity on the infected computer system. Malware can complete a range of activities such as encrypting data and requesting money for the data to be decrypted (ransomware, e.g. see the Wannacry malware) or monitoring data and sending it to the attacker (spyware). Another type of malware which is helpful to be aware of is “zero day” malware, or sometimes referred to as a zero day exploit. Zero day refers to malware which exploits a vulnerability which has not yet been patched by vendors, leaving threat actors to exploit this before a patch is made available.</p>
<p>Malware can be classified into three main types; viruses, trojans, and worms.</p>
<h2 id="viruses">Viruses</h2>
<p>A computer virus is malicious executable code which self-propagates. That is, it multiplies itself, typically by attaching itself to what’s called a host document. This can be an executable file such as .exe files, Unix shell scripts, Windows batch files, and macros but can also be office documents such as word files and pdfs. When the host opens and the virus code is run it begins to propagate by attaching itself to uninfected files. It continues to attach itself to more and more hosts. One of its main aims is to infect as many hosts as possible.</p>
<p>However, when it does attach to a new host, it doesn’t necessarily have to be an exact copy. This can be referred to as a mutating virus, also known as a polymorphic virus. So why wouldn’t the attacker want this to be an exact copy? Well, if it stays exactly the same, it makes it easier to spot the virus in the long run. Thus to make it harder to detect, we might want to mutate that virus as it spreads.</p>
<p>Once you have a virus on your system, it will first try to find a suitable host to copy itself to. Before it copies itself, it will check whether that file has already been infected. If it doesn’t check this and it has already attached itself to that file, then if it keeps attaching itself, then the size of that file could grow much larger, which makes it easier to detect that an infection has taken place.</p>
<p>If the host hasn’t been infected already, then the virus will copy itself into that host and leave what is referred to as a signature. This is something that indicates the file has already been infected. So, for example, an impossible date. The next time that file is run, then the virus code is run along with it. So normally, the virus stops running when the host stops, but some viruses can continue on in the background.</p>
<p>A virus has three main parts. It has code related to concealment, propagation, and payload. Concealment is to hide itself from detection such as through antivirus software. Propagation is the need for it to find files and infect them, and add a signature as we’ve already discussed. The payload is any code not related to either concealment or propagation. For example, this could be things such as trying to copy data and send it back to the attacker.</p>
<p>We can classify viruses on the basis of the trigger type. The trigger is what makes the virus payload execute. A logic bomb only triggers when specified conditions are met. For example, if an employee thinks they’re going to be fired and they insert code which checks to see if there’s been any activity on their account in the last 30 days and if not it starts to delete files.</p>
<p>In contrast, a time bomb triggers at a certain date or time. For example, the Priscilla virus spread via email in an infected Word document. On the 25th of December, it would trigger, and the message was displayed, coloured blocks added to Word documents and, on the next reboot, it also attempted to reformat the hard drive.</p>
<p>We can also classify viruses based on the infection mechanism i.e. how it spreads itself. It could be a file infector. This is where it embeds itself in an .exe and is run when the infected file is run. It could also be a boot sector. So it embeds itself in the boot sector of a disk, the small part of a hard disk or external storage, for example. It then becomes memory resident when the computer is booted from this, if the disk is bootable, or when the disk is inserted into a disk drive and is read. An email virus is when it is attached to an email. And a macro, similarly, is attached in a macro, such as those used in Excel spreadsheets. Finally, it could be an operating system infection mechanism, where it attaches itself to an operating system file.</p>
<h2 id="worms">Worms</h2>
<p>Unlike viruses, worms don’t need human interaction in order to spread. They exist on a computer as a separate program. A worm relies on a network to send copies of itself out to other machines on that network by exploiting vulnerabilities in applications and protocols. They can consume bandwidth and allow hackers to access your machine remotely. So, for example, the Blaster worm spread itself across networks and forced computers to constantly reboot, eventually causing a distributed denial of service on the Windows website.</p>
<p>Once the computer has been infected by the code the virus can try to replicate across the network without further user interaction. There are several ways of achieving this, such as by using Unix remote shell scripts like SSH, the secure network protocol, to remotely log into a Unix machine. Remote access to the target machine could be gained by cracking a password of a user and logging in as them remotely, hence infecting another machine. It could also be through bugs and networking software.</p>
<p>Worms can also be used for spewing spam. Another worm which is notable was the Witty worm in 2004. This is thought to be the first widely-propagated internet worm which had a destructive or malicious payload. In particular, it took advantage of a security flaw in firewalls to propagate, and repeatedly deleted sections of hard drives, thus over time, rendering the machine unusable.</p>
<h2 id="trojans">Trojans</h2>
<p>Trojans are distinct from viruses and worms, as they do not attempt to propagate themselves. They are innocuous computer programs which hide a virus or other potentially damaging programs, such as a key logger. A key logger is a type of spyware. This means it gathers information on an infected machine and communicates it back to the attacker. In particular, a key logger logs all the keystrokes of a user. This could be sensitive information, such as usernames and passwords, and so forth.</p>
<p>Trojans often includes something called a backdoor. This gives the attackers a way to bypass normal authentication or other security mechanisms and gain remote control over the infected computer. This can be referred to as a Remote Access Trojan (RAT). RATs can often include code which helps hide the malicious activity, making it more difficult to detect.</p>
<h2 id="malware-detection-and-prevention">Malware Detection and Prevention</h2>
<p>There are three general areas which we can explore to aid in preventing and detecting malware. Increasing user awareness can help avoid risky behaviours which could result in malware infection. For example, increased awareness resulting in avoidance of downloading questionable files from the internet.</p>
<p>We can also explore technical solutions – e.g. write- protect sensitive parts of disk, use of intrusion detection and prevention systems and firewalls amongst other options.</p>
<p>Additionally, antivirus software identifies and removes malware from an infected computer and also tries to stop it getting infected in the first place.</p>
<h3 id="antivirus-approaches">Antivirus Approaches</h3>
<p>There are several approaches to antivirus. One common approach is using virus dictionaries. Every file on a computer is searched for signatures associated with known viruses.</p>
<p>However, this requires end users to keep virus definitions up to date and to perform anti-virus scans regularly. It is also unable to recognise unknown viruses which haven’t yet had a signature added to the dictionary. Similarly, it has difficulty with polymorphic viruses, which encrypts parts of themselves or otherwise modify themselves, as a method of disguise so as not to match the virus signature in the dictionary.</p>
<h3 id="integrity-checkers">Integrity Checkers</h3>
<p>Another approach is an integrity checker. Integrity checkers aim to identify changes to files as a result of viruses. So for example, a very old file which has been recently modified. It alerts the user, who then decides what to do with that file. However, there is a bit of a downside to this.</p>
<p>If a change has been detected, then the virus still has to be identified and located. The downside is that it can only be found when a virus has already done some damage. So in theory, the dictionary approach means that it can be detected before the damage is done. On the other hand, an integrity checker can discover the effects of a mutating virus.</p>
<h3 id="activity-monitoring">Activity Monitoring</h3>
<p>Another approach is the activity monitoring approach. This approach involves monitoring activities of all programs and looking for suspicious behaviour, such as a program trying to write executable codes to another program. Other activities which might raise suspicion include changing program length, programs slowing down, or the system taking longer to start. This then alerts the user, and asks them what they want to do to it. It has the benefit of identifying new viruses, but may also flag a lot of false positives.</p>
<p>In the activity monitor approach the antivirus should quarantine the suspected file. This means it places the suspected file or program into a new location where it can’t impact the rest of your system. The use can either decide to remove it or restore it.</p>
<p>Quarantining can take a number of forms. One approach is to use a sandbox, an environment which is cornered off from the main operating system such that anything that is created or changed by the sandbox application isn’t accessible outside of the sandbox and any changes made by the application aren’t saved. So if, for example, it downloaded and installed malware, then this would be removed when the application stopped running. Another approach is to use containers such as <a href="https://www.docker.com/resources/what-container/">Docker</a>.</p>
</div>
</body>

</html>
